#include "shaders.h"
#pragma data_seg(".shaders")
const struct shader_entry_t _shaders[NUM_SHADERS] = {
	{ "common.glsl" , "#version 150\n#extension GL_ARB_explicit_attrib_location:enable\nuniform float t,b;\n\nfloat scene(vec3 p, out vec3 c);\nvec3 lpos();\nfloat dbox(vec3 v,vec3 l,vec3 s){\nvec3 f=abs(l-v)-s;\nreturn max(f.x,max(f.y,f.z));\n\n}\nvec3 n_at(vec3 v){\nvec3 f,s;\nf.x=scene(v+vec3(.001,0,0),s)-scene(v-vec3(.001,0,0),s);\nf.y=scene(v+vec3(0,.001,0),s)-scene(v-vec3(0,.001,0),s);\nf.z=scene(v+vec3(0,0,.001),s)-scene(v-vec3(0,0,.001),s);\nreturn normalize(f);\n\n}\nvec3 light(vec3 v,vec3 s){\nvec3 f=v-lpos();\nfloat l=length(f);\nf=normalize(f);\nvec3 n=n_at(v);\nfloat y=max(dot(-f,n),0.);\nvec3 e=s*y*vec3(.8);\nreturn e+s*vec3(.2);\n\n}\nvec3 raymarch(vec3 v,vec2 f){\nvec3 s=vec3(0,0,0);\ns+=vec3(1,0,0)*f.x;\ns+=vec3(0,1,0)*f.y*.5625;\ns+=-vec3(0,0,1)*1;\ns=normalize(s);\nvec3 n;\nfloat l=0.;\nfor(int r=0;\nr<500&&l<1000;\nr++){\nfloat y=scene(v,n);\nif(y<.001)return light(v,n);\nl+=abs(y);\nv+=s*y;\n\n}\nreturn vec3(0);\n\n}\n" },
	{ "intro" , "in vec2 p;\nin vec3 c;\nout vec3 oc;\nvoid main(){\noc=raymarch(vec3(0,0,0),p);\n\n}\nfloat scene(vec3 v,out vec3 y){\nreturn y=vec3(.7,0,.7),v.x=mod(abs(v.x),vec3(50).x)-vec3(50).x*.5,v.y=mod(abs(v.y),vec3(50).y)-vec3(50).y*.5,v.z=mod(abs(v.z),vec3(50).z)-vec3(50).z*.5,dbox(v,vec3(25),vec3(40));\n\n}\nvec3 lpos(){\nreturn vec3(sin(t),0,cos(t))*50.;\n\n}\n" },
	{ "vertex.glsl" , "layout(location=0)in vec2 ip;\nout vec2 p;\nout vec3 c;\nvoid main(){\np=ip,gl_Position=vec4(ip,0.,1.);\n\n}\n" },
};
