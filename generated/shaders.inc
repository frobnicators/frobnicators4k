#pragma data_seg(".shaders")
static const char * _shaders[] = {
	{ "#version 150\n#extension GL_ARB_explicit_attrib_location:enable\nuniform float t,s,s2;float max_dist;struct Ray{vec3 po;vec3 d;};\nvec4 scene(vec3 p);vec3 slight(Ray r, vec4 c);vec3 bg(Ray r, vec4 c);float dsphere(vec3 v,vec3 y,float w){return length(v-y)-w;}float dbox(vec3 v,vec3 y,vec3 w){vec3 f=abs(y-v)-w;return max(f.x,max(f.y,f.z));}vec3 rotateY(vec3 v,float f){float y,w;y=sin(f);w=cos(f);return vec3(v.x*w+v.z*y,v.y,v.z*w-v.x*y);}vec3 permute(vec3 v){return mod((v*34.+1.)*v,289);}float snoise(vec2 v){const vec4 f=vec4(.211,.366,-.577,.024);vec2 y=floor(v+dot(v,f.yy)),w=v-y+dot(y,f.xx),m;m=w.x>w.y?vec2(1.,0.):vec2(0.,1.);vec4 i=w.xyxy+f.xxzz;i.xy-=m;vec3 d=permute(permute(y.y+vec3(0.,m.y,1.))+y.x+vec3(0.,m.x,1.)),x=max(.5-vec3(dot(w,w),dot(i.xy,i.xy),dot(i.zw,i.zw)),0.);x=pow(x,vec3(4));vec3 o=2.*fract(d*f.www)-1.,z=abs(o)-.5,n=floor(o+.5),p=o-n;x*=1.79-.85*(p*p+z*z);vec3 r;r.x=p.x*w.x+z.x*w.y;r.yz=p.yz*i.xz+z.yz*i.yw;return 130.*dot(x,r);}float fbm(in vec2 v,int w){float y=0.;for(float f=0;f<w;f++)y+=pow(.3,f)*snoise(pow(2.,f)*v);return y;}vec4 cast_ray(inout Ray v,float w){vec3 f=v.po;float y=0;for(int r=0;y<w;r++){vec4 i=scene(v.po);if(i.w<.001)return v.po+=v.d*clamp(i.w,-10.,0),i;i.w=max(.001*y,i.w);v.po+=v.d*i.w;y=length(f-v.po);}return vec4(-1);}vec3 n_at(vec3 v){vec3 f;f.x=scene(v+vec3(.001,0,0)).w-scene(v-vec3(.001,0,0)).w;f.y=scene(v+vec3(0,.001,0)).w-scene(v-vec3(0,.001,0)).w;f.z=scene(v+vec3(0,0,.001)).w-scene(v-vec3(0,0,.001)).w;return normalize(f);}float shadow(vec3 v,vec3 y,float w){v-=y*.5;float f=1.,i=0;for(int r=0;r<50&&i<w;r++){vec4 d=scene(v);if(d.w<.001)return 0.;float m=max(.001*i*2,d.w);i+=m;f=min(f,60.*d.w/i);v-=y*m;}return f;}vec3 light(Ray v,vec4 f,vec3 w){vec3 y=v.po-w;float i=length(y);y=normalize(y);vec3 m=n_at(v.po);float d=max(dot(-y,m),0.)*shadow(v.po,y,i);vec3 r=f.xyz*d*vec3(.8);return r+f.xyz*vec3(.2);}vec3 raymarch(Ray v,float f,int w){vec3 y;for(int r=0;r<w+1;++r){vec4 i=cast_ray(v,max_dist);if(i.x>-.5)y=mix(slight(v,i),y,f*r/2.),v.d=reflect(v.d,n_at(v.po)),v.po+=v.d;else{y=mix(bg(v,i),y,1.5*f*r/2.);break;}}return y;}vec3 post(vec3 v,float w){float f=dot(vec3(.3,.59,.11),v);return v*f*w;}" },
	{ "in vec2 p;in vec3 ro,rd;out vec3 oc;void main(){max_dist=100.;Ray v;v.po=ro;v.d=normalize(rd);oc=raymarch(v,1.5,1);oc=post(oc,10.+s*10.);}vec4 scene(vec3 v){vec4 r;r.xyz=vec3(.7,0,.7);r.w=dbox(mod(v,vec3(20)),vec3(10),vec3(6))+.5*sin(t)*fbm(.2*v.xz,1);float s=dsphere(v,vec3(sin(t*1.2)*10.,0.,t+10),1.f);if(s<r.w)r.w=s,r.xyz=vec3(.2,.8,0.);return r;}vec3 lpos(){if(t>20.)return vec3(sin(t*1.2)*50.,0,t+2.);else return ro+vec3(0.,0.,20.);}vec3 slight(Ray v,vec4 r){return light(v,r,lpos())+r.xyz*.1;}vec3 bg(Ray v,vec4 r){return vec3(s2,s,s);}" },
	{ "in vec2 p;in vec3 ro,rd;out vec3 oc;void main(){max_dist=500.;Ray v;v.po=ro;v.d=normalize(rd);oc=raymarch(v,t>87?1.5:2.,t>87?1:0);oc=post(oc,3.);}vec4 scene(vec3 v){float s=fbm(v.xz/100.,6)*30.,t=v.y-(s-50.);return vec4(.1,.8,.3,t);}vec3 slight(Ray v,vec4 t){return light(v,t,v.po+vec3(0,50-s*20.,50));}vec3 bg(Ray v,vec4 t){float s=clamp(sin(t),0.,1.);return vec3(p.x,p.y,0)*.5+vec3(s*s,s2,s*(1-s));}" },
	{ "layout(location=0)in vec2 ip;out vec2 p;out vec3 ro,rd;mat3 rmat(float t){float v=sin(t),o=cos(t),n=1.-o;return mat3(o,-v,0,v,o,0,0,0,n+o);}void cam(out vec3 v[4]){mat3 n=mat3(1.);float o=1.;if(t>16.)n=rmat((t-16.)*.1);if(t>48.)n=mat3(1.),o=2.;if(t>73.)o=5.;if(t>80.)o=7.;v=vec3[4](vec3(0,0,-5+t*o),n*vec3(1,0,0),n*vec3(0,1,0),n*vec3(0,0,-1));}void main(){p=ip;gl_Position=vec4(ip,0.,1.);vec3 o=gl_Position.xyz*vec3(1.7777,1.,0)+vec3(0,0,-1),t[4];cam(t);ro=t[0];rd.x=dot(o,t[1]);rd.y=dot(o,t[2]);rd.z=dot(o,t[3]);}" },
};
