#pragma data_seg(".shaders")
static const char * _shaders[] = {
	{ "#version 150\n#extension GL_ARB_explicit_attrib_location:enable\nuniform float t;float max_dist;struct Ray{vec3 po;vec3 d;};\nvec4 scene(vec3 p);vec3 slight(Ray r, vec4 c);vec3 bg(Ray r, vec4 c);float db(vec3 v,vec3 f,vec3 w){vec3 d=abs(f-v)-w;return max(d.x,max(d.y,d.z));}vec3 pm(vec3 v){return mod((v*34.+1.)*v,289);}float sn(vec2 v){const vec4 d=vec4(.211,.366,-.577,.024);vec2 f=floor(v+dot(v,d.yy)),s=v-f+dot(f,d.xx),m;m=s.x>s.y?vec2(1.,0.):vec2(0.,1.);vec4 i=s.xyxy+d.xxzz;i.xy-=m;vec3 z=pm(pm(f.y+vec3(0.,m.y,1.))+f.x+vec3(0.,m.x,1.)),x=max(.5-vec3(dot(s,s),dot(i.xy,i.xy),dot(i.zw,i.zw)),0.);x=pow(x,vec3(4));vec3 w=2.*fract(z*d.www)-1.,o=abs(w)-.5,y=floor(w+.5),p=w-y;x*=1.79-.85*(p*p+o*o);vec3 r;r.x=p.x*s.x+o.x*s.y;r.yz=p.yz*i.xz+o.yz*i.yw;return 130.*dot(x,r);}float fbm(in vec2 v,int w){float f=0.;for(float d=0;d<w;d++)f+=pow(.3,d)*sn(pow(2.,d)*v);return f;}vec4 cry(inout Ray v,float w){vec3 f=v.po;float d=0;for(int r=0;d<w;r++){vec4 i=scene(v.po);if(i.w<.001)return v.po+=v.d*clamp(i.w,-10.,0),i;i.w=max(.001*d,i.w);v.po+=v.d*i.w;d=length(f-v.po);}return vec4(-1);}vec3 n_at(vec3 v){vec3 i;i.x=scene(v+vec3(.001,0,0)).w-scene(v-vec3(.001,0,0)).w;i.y=scene(v+vec3(0,.001,0)).w-scene(v-vec3(0,.001,0)).w;i.z=scene(v+vec3(0,0,.001)).w-scene(v-vec3(0,0,.001)).w;return normalize(i);}vec3 light(Ray v,vec4 i,vec3 w){vec3 f=v.po-w;float d=length(f);f=normalize(f);vec3 m=n_at(v.po);float z=max(dot(-f,m),0.);vec3 x=i.xyz*z*vec3(.8);return x+i.xyz*vec3(.2);}vec3 rym(Ray v,float d,int w){vec3 f;for(int i=0;i<w+1;++i){vec4 m=cry(v,max_dist);if(m.x>-.5)f=mix(slight(v,m),f,d*i/2.),v.d=reflect(v.d,n_at(v.po)),v.po+=v.d;else{f=mix(bg(v,m),f,d*i/2.);break;}}return f;}" },
	{ "in vec2 p;in vec3 ro,rd;uniform float syc,s2;out vec3 oc;\n#define HEIGHTS_AT 50.\nvoid main(){max_dist=100.;Ray v;v.po=ro;v.d=normalize(rd);float s=2.;int t=0;if(t<HEIGHTS_AT||t>87)s=1.5,t=1;if(t>=HEIGHTS_AT)max_dist=500.;oc=rym(v,s,t);}vec4 scene(vec3 v){if(t<HEIGHTS_AT)return vec4(.7,0,.7,db(mod(v,vec3(20)),vec3(10),vec3(6))+.5*sin(t)*fbm(.2*v.xz,1));else{float t=fbm(v.xz/100.,6)*30.,s=v.y-(t-50.);return vec4(.1,.8,.3,s);}}vec3 lpos(Ray v){if(t<HEIGHTS_AT)return ro+vec3(0.,0.,20.);else return v.po+vec3(0,50-syc*20.,50);}vec3 slight(Ray v,vec4 s){return light(v,s,lpos(v))+s.xyz*.1;}vec3 bg(Ray v,vec4 s){if(t<HEIGHTS_AT)return vec3(s2,syc,syc);else{float t=clamp(sin(t),0.,1.);return vec3(p.x,p.y,0)*.5+vec3(syc*t,s2,syc*(1-t));}}" },
	{ "layout(location=0)in vec2 ip;out vec2 p;out vec3 ro,rd;mat3 rmat(float t){float v=sin(t),o=cos(t),n=1.-o;return mat3(o,-v,0,v,o,0,0,0,n+o);}void cam(out vec3 v[4]){mat3 n=mat3(1.);float o=1.;if(t>5.)n=rmat((t-5.)*.1);if(t>33.)n=mat3(1.),o=2.;if(t>58.)o=5.;if(t>65.)o=7.;v=vec3[4](vec3(0,0,-5+t*o),n*vec3(1,0,0),n*vec3(0,1,0),n*vec3(0,0,-1));}void main(){p=ip;gl_Position=vec4(ip,0.,1.);vec3 o=gl_Position.xyz*vec3(1.7777,1.,0)+vec3(0,0,-1),t[4];cam(t);ro=t[0];rd.x=dot(o,t[1]);rd.y=dot(o,t[2]);rd.z=dot(o,t[3]);}" },
};
